clf; close all;
figure('Visible','Off');
mForce = [125.69955,119.14418,119.02170,119.91101,125.16170,124.00879,121.15979,116.85699,121.74290,125.74482,129.12367,132.79277,127.20659,121.82810,123.59076,129.57632,131.10201,131.86884,128.79617,127.74178,125.91522,122.84522,119.70333,119.83913,117.30431,116.86497,120.61128,123.38840,123.73720,122.40056,118.11641,119.25334,124.27505,126.73531,126.24006,122.74937,119.70333,123.32449,124.66912,125.87262,126.89773,124.44279,122.33665,119.91901,122.76267,123.51353,128.85475,130.93958,131.90344,134.39034,136.90118,135.88406,135.41544,136.71480,131.90344,126.83915,126.51165,125.94717,128.24767,127.94946,128.71629,125.56642,124.23244,131.78896,131.84753,131.30969,130.98750,126.77258,128.02934,130.76120,133.79124,132.60904,131.75966,129.95174,127.97076,124.99663,127.08944,129.06511,126.91903,131.77565,135.10658,132.36407,129.51508,123.31118,120.97340,123.26324,122.21418,120.99737,122.83191,127.75242,131.36295,130.03696,126.84981,127.33707,128.12253,135.70300,136.64290,128.68169,124.43214,125.84599,128.74825,132.02060,126.13888,122.42986,122.89049,125.70488,127.59267,123.30054,123.43633,121.71628,121.26363,125.85664,129.26746,128.04532,125.77943,125.75013,122.57363,122.94374,120.89618,120.43022,126.14420,129.82927,125.77144,121.27161,122.92776,124.46942,124.50936,123.14610,125.31613,123.50022,119.34122,116.49487,121.14114,122.81061,119.29861,118.38268,123.30054,125.14839,124.96466,128.21306,131.42683,129.33670,130.07956,129.44852,132.28419,132.90991,126.71135,124.41616,127.20924,128.23438,129.57100,131.42683,133.49037,132.07652,133.96965,135.51929,133.40782,125.58772,125.12709,127.99473,129.53372,125.90192,127.97343,126.65543,125.24691,125.94450,125.32677,125.17501,127.52612,125.43862,122.73073,124.86614,126.84981,132.52118,134.75244,131.80228,132.38538,134.74181,134.91487,131.10999,126.67407,120.14532,121.47663,124.72504,129.50177,132.16971,126.56223,124.15258,128.15448,125.75546,127.97076,129.37929,130.34048,128.11986,123.97151,124.76498,126.63945,123.81975,125.42796,128.87871,126.22675,123.95287,123.75051,124.88745,125.70488,127.30244,127.78705,127.56870,126.20811,129.44852,130.65202,131.53867,129.94641,126.75927,117.75696,114.48727,116.35110,121.12251,127.62462,128.24236,133.07767,132.97649,127.13737,129.25148,130.47362,129.40059,132.37207,134.19595,132.58241,130.67598,127.33440,127.76041,134.23590,136.53641,128.31424,122.91712,124.34694,125.34277,124.41351,126.12556,125.11111,124.69840,122.83458,127.62728,126.55425,123.37774,125.80872,128.70566,129.11037,129.76004,132.41466,133.89510,129.81595,124.13126,123.84370,124.86614,128.76688,129.05978,127.83231,131.20052,133.47440,127.93615,124.05672,123.66265,128.82547,128.77753,125.11909,122.36329,121.81213,122.04642,122.76267,124.17387,130.64137,133.13091,129.89850,126.84715,131.19254,131.34430,129.89050,129.21155,129.13432,130.00766,132.78745,133.38652,133.78592,137.65738,140.92973,141.49687,138.55467,136.51244,136.60829,137.54553,140.20284,138.80495,137.34319,137.39111,135.63644,133.69806,136.53374,136.69084,136.67754,135.94530,130.46562,123.34314,122.21685,121.18108,119.70333,121.66834,121.83610,119.91634,118.31611,124.62652,126.64745,124.91408,126.73531,128.01337,127.49416,124.42682,114.63904,112.80715,118.72615,126.85513,130.89432,130.17009,124.26174,122.39525,124.28836,122.55233,122.14761,121.14114,126.47970,130.21002,128.75092,128.34087,133.53297,134.26787,133.28268,128.53523,125.03122,122.26212,122.05975,130.10086,131.58661,132.48390,129.12367,126.74863,124.78095,123.73987,127.55006,128.89470,127.77107,129.27278,128.45535,131.03545,132.61169,132.54514,138.54402,134.00691,127.55540,127.98409,130.69995,132.58775,130.01299,131.28838,131.78629,131.20319,129.77336,129.94641,129.10770,128.58049,134.90421,138.24315,138.19788,137.48695,133.82854,136.25150,138.06474,131.19786,126.08296,124.36557,126.02438,132.65697,132.66496,129.15828,125.20431,127.82166,128.53523,128.19174,126.60484,129.71478,133.10429,132.01262,125.13773,128.08525,131.44815,133.99628,131.63452,130.92894,133.98296,137.28195,138.58928,137.53755,134.25188,134.29980,131.50139,127.10008,129.93845,132.78212,134.86429,136.81065,138.42686,142.42612,136.28879,133.46907,133.46375,134.90421,138.17125,142.39149,138.74904,138.36829,139.59842,142.01341,139.71291,135.16782,137.82777,139.25760,142.09862,142.80687,136.85858,132.97383,135.54591,138.28575,140.86049,142.18648,141.97612,139.76881,137.10353,139.76349,144.04765,142.41280,142.45807,147.26675,145.87421,144.01303,142.58055,142.07732,146.51855,147.39191,148.69125,151.57487,150.01459,151.73996,153.80881,152.25117,152.49879,154.30141,156.64450,158.88908,158.26338,161.36000,161.09106,163.16525,161.21089,162.21471,164.97583,162.93095,164.33946,161.92447,166.13408,169.99220,172.47377,173.21399,171.77083,174.63849,176.18813,177.24252,178.86140,179.11700,182.30682,183.23074,184.37300,185.52060,184.31444,184.81500,185.15050,188.83290,188.76633,190.51033,191.50349,194.42439,195.29507,195.51607,197.04440,199.05736,199.62981,199.43544,200.89191,202.96873,206.13191,206.08665,206.60321,206.27837,208.23540,209.89687,213.03078,215.46706,216.03154,216.42561,217.59717,217.75691,220.12399,222.54166,222.49637,223.83833,224.86078,226.51959,227.12135,229.26741,231.17119,232.84332,234.37433,235.53256,235.60179,236.59760,239.22028,240.06700,242.85474,244.30588,244.26328,243.54971,246.17769,249.55391,249.53528,249.79622,252.08339,254.93774,257.47784,256.59918,257.10776,257.95181,258.61212,259.67715,261.87115,262.88831,264.59503,265.25537,266.41357,268.56235,268.13098,268.60226,270.76431,273.63464,274.94733,275.98041,277.68182,277.24780,277.89481,279.92639,281.34555,282.79138,284.52475,287.23792,288.09531,288.38022,290.35855,290.85910,292.41406,293.35931,295.77429,297.28668,298.43158,300.33270,302.90479,304.60086,304.63550,305.76974,308.54688,310.27225,312.07751,313.36356,314.22357,315.21143,316.01553,317.49591,318.60358,320.69641,322.02237,322.46973,323.85159,325.23883,326.55682,328.91855,330.32175,332.21490,334.24646,335.84671,337.25256,338.40015,339.18030,339.86990,340.32791,342.51392,346.01526,348.24384,349.40741,351.34583,352.67181,353.48920,353.47324,355.15332,356.15182,358.19672,359.00882,360.64633,363.32758,364.36600,366.33099,368.07239,369.47290,370.55392,371.32874,372.13287,373.16864,374.10321,377.35159,378.25424,379.03171,380.69583,381.65707,381.32156,382.41324,382.94043,383.27856,383.77914,386.26605,386.44180];
mSep = [87.449280,86.499313,86.303314,86.226013,86.660751,86.343788,85.827194,85.139618,85.529793,85.816284,86.029106,86.275124,85.434746,84.618477,84.639397,85.155533,85.147804,85.050491,84.502518,84.191017,83.788567,83.240593,82.683525,82.511177,82.025505,81.785400,82.037331,82.176033,82.029602,81.685356,80.995956,80.943207,81.347023,81.450256,81.206963,80.613060,80.071007,80.312477,80.287010,80.245628,80.182869,79.712662,79.283379,78.818626,78.970062,78.877289,79.322945,79.386612,79.317940,79.428902,79.542587,79.242455,79.005989,78.976883,78.230186,77.453934,77.233833,76.985092,77.072403,76.854118,76.760895,76.207016,75.866409,76.568085,76.389824,76.141075,75.917343,75.236130,75.196564,75.329811,75.498062,75.172012,74.885063,74.485794,74.065613,73.529915,73.589035,73.634514,73.197044,73.581757,73.788216,73.282082,72.764580,71.853722,71.397156,71.484009,71.179787,70.856003,70.891022,71.288467,71.532669,71.197517,70.644089,70.522217,70.435364,71.145226,71.075645,69.962425,69.283485,69.269394,69.429916,69.633186,68.762802,68.146164,68.018837,68.167534,68.207100,67.520889,67.353996,66.968826,66.732353,67.087509,67.303520,66.976097,66.524986,66.336723,65.778748,65.636414,65.210770,64.970207,65.454971,65.701439,65.039330,64.324921,64.332649,64.327194,64.145294,63.798325,63.866081,63.466358,62.790604,62.269463,62.627804,62.635990,62.036179,61.741501,62.131222,62.160324,61.951141,62.144863,62.334038,61.901119,61.801075,61.539139,61.684204,61.569607,60.654202,60.197182,60.336788,60.269032,60.237652,60.266758,60.320873,59.966167,59.999821,59.993454,59.557350,58.451405,58.209480,58.358639,58.351360,57.737907,57.794296,57.452782,57.101261,56.997124,56.739281,56.536465,56.627415,56.197678,55.695637,55.762486,55.811142,56.293629,56.371845,55.842522,55.728378,55.822056,55.659256,55.030342,54.326847,53.377789,53.350960,53.549683,53.926670,54.057182,53.215900,52.749783,53.035820,52.571068,52.647011,52.628365,52.557426,52.112682,51.441475,51.350071,51.385540,50.869858,50.873951,51.094501,50.598373,50.147720,49.938992,49.888512,49.799839,49.803474,49.676601,49.467419,49.124084,49.321442,49.279606,49.200935,48.831680,48.275524,47.037247,46.471996,46.509285,46.887634,47.469711,47.361027,47.748016,47.555202,46.689819,46.757576,46.720287,46.414242,46.582954,46.616604,46.246895,45.842625,45.270100,45.139130,45.718025,45.806702,44.660282,43.844921,43.830368,43.764885,43.472939,43.490673,43.187809,42.955433,42.551620,42.929516,42.617558,42.058674,42.157352,42.310604,42.170540,42.059128,42.182819,42.168720,41.502064,40.646683,40.424313,40.356098,40.625763,40.472061,40.140095,40.347458,40.427040,39.589394,38.946838,38.714462,39.133739,38.941833,38.326107,37.817245,37.567589,37.410702,37.309746,37.292011,37.867268,37.975952,37.413883,36.872734,37.200607,37.036442,36.684013,36.422989,36.232449,36.153324,36.297932,36.186520,36.051914,36.324764,36.527126,36.411621,35.884567,35.462563,35.291122,35.218365,35.347965,35.000996,34.646290,34.468941,34.080585,33.669495,33.819107,33.654942,33.469406,33.200649,32.374374,31.355284,31.040600,30.735464,30.378942,30.426235,30.262527,29.854164,29.483089,30.039700,30.094271,29.707281,29.738203,29.704098,29.460352,28.917383,27.585884,27.187525,27.699570,28.470367,28.761860,28.494469,27.618172,27.217083,27.256191,26.870111,26.640009,26.338966,26.782801,27.037458,26.683664,26.452198,26.878752,26.781435,26.482666,25.742792,25.148438,24.640030,24.433575,25.193913,25.184818,25.107512,24.530436,24.068413,23.654593,23.350367,23.614574,23.589563,23.275333,23.268967,22.990208,23.110716,23.112989,22.922905,23.443590,22.727818,21.787401,21.653704,21.788765,21.825600,21.338110,21.302639,21.174856,20.920652,20.565948,20.398602,20.113020,19.863819,20.417702,20.620974,20.427706,20.155312,19.537310,19.633263,19.657364,18.662830,17.874300,17.485035,17.491858,18.082573,17.896582,17.298134,16.647390,16.768808,16.667400,16.441845,16.071680,16.252216,16.467312,16.155809,15.166734,15.330897,15.544629,15.662408,15.204932,14.942088,15.120350,15.327714,15.301794,14.998477,14.433227,14.259513,13.751105,13.054432,13.207228,13.360477,13.423687,13.471436,13.479621,13.767021,12.864347,12.350483,12.166765,12.152668,12.351848,12.662895,12.050805,11.821157,11.779776,11.877546,11.421889,10.702479,10.827990,10.809799,10.957137,10.853909,9.9703360,9.3286867,9.4455576,9.5828905,9.7011251,9.6729307,9.4655657,9.0240068,8.5292416,8.6606636,8.9821701,8.6097317,8.4355631,8.8198252,8.4773998,8.0794964,7.7325239,7.4946909,7.8371158,7.7607183,7.7347975,7.8944139,7.5324349,7.5556273,7.6192918,7.2573128,7.1067915,7.1386237,7.2336659,7.3164301,7.0626812,7.2445803,7.0313034,7.0926943,6.6806931,6.6152096,6.7557268,6.3319020,6.3128028,5.8448677,6.1536412,6.4210324,6.5265341,6.4278536,6.0726962,6.2227626,6.2182155,6.1554604,6.1586432,6.0017557,6.1886568,6.1099854,6.0567799,6.0040293,5.6747923,5.5456438,5.3973961,5.6415958,5.4460545,5.4624252,5.3914847,5.5465536,5.4610610,5.2991710,5.2909856,5.3396435,5.2195902,5.0094967,4.9935808,5.0504241,5.2350516,5.0426931,4.9167285,4.6925378,4.7361937,4.7443790,4.9267330,5.0267773,4.9076333,4.7684808,4.7216415,4.5556588,4.6493368,4.7493815,4.5606613,4.5347404,4.4724402,4.4847183,4.3733053,4.4437909,4.4860826,4.5015440,4.5001798,4.4556146,4.2832651,4.2196007,4.3469300,4.2655301,4.4124136,4.4014997,4.2155080,3.9503903,4.0772648,4.2914510,4.1077328,3.9563019,4.0417943,4.1945896,4.3096404,4.0236044,3.9003680,3.8162398,3.7102835,3.6516213,3.7252903,3.6607161,3.6775417,3.5711310,3.5233824,3.5925040,3.3578544,3.2300704,3.3005562,3.4542608,3.4251571,3.3637662,3.3815012,3.1482160,3.0422597,3.0991032,3.0845513,3.0727279,3.0950105,3.2327988,3.1527634,3.0058799,3.0577211,2.9363036,2.9385774,2.8694558,2.9726834,2.9695003,2.9235706,2.9654074,3.0863702,3.1045601,2.9267540,2.8780959,3.0208867,3.0395312,3.0677257,3.0336196,2.9490366,2.8780959,2.7853274,2.7707756,2.7112038,2.7671375,2.7316673,2.5920599,2.5615919,2.5306690,2.4915607,2.5734153,2.5429473,2.5697773,2.6120689,2.6034286,2.5725057,2.5106602,2.4065230,2.2910171,2.1500454,2.2118912,2.4283509,2.4970176,2.4424481,2.4792826,2.4465408,2.3551366,2.1686902,2.1827872,2.1191227,2.1809683,2.1004779,2.1195774,2.2641871,2.2196219,2.2869244,2.3314896,2.3401299,2.3151188,2.2587302,2.2100720,2.1932464,2.1695995,2.4224391,2.4051588,2.3787835,2.4620020,2.4683685,2.3283064,2.3615029,2.3346729,2.2914720,2.2728271,2.4933798,2.4479051];
% get something that looks like a normalized exponential (1-->0)
% only look at the last 'nPoints' points
nPoints = 200;
decaying = mForce(end-nPoints:end);
sep = mSep(end-nPoints:end);
sep = sep - min(sep);
minV = min(decaying);
maxV = max(decaying);
decaying = (decaying - minV)/(maxV-minV);
% sort everything min to max sep
[~,I] = sort(sep);
sep = sep(I);
decaying = decaying(I);
% fit a polynomial model to it
deg = 7;
[ ~,predicted,tauDist ] = FitPolynomialLP_Exponential( sep,decaying,deg );
% fit an exponential model  using a logairthmic model
[tauLog,predXLog,predYLog] = FitLogarithmicLP_Exponential( sep,decaying );
% get the coefficients
% compare to 'true' exponential fit (not an LP )
[ tauExp,predExp ] = FitNonLinearExponential( sep,decaying );
hold all;
% plot the true data
plot(sep,decaying,'o','Color',[0.4,0.4,0.4]);
% plot the models
lw = 4;
xlabel('Separation (arb)');
ylabel('Force (arb)');
mLeg = {'Raw Data','Non Linear Exp','Polynomial Taylor','Logarithm'};
legend(mLeg)
PlotBeautify();
SaveCurrentFigure('./5_Output/SingleExp1_RawDataExample')
plot(sep,predExp,'g--','linewidth',lw)
legend(mLeg);
PlotBeautify();
SaveCurrentFigure('./5_Output/SingleExp2_ExpExample')
plot(sep,predicted,'b-','linewidth',lw)
plot(predXLog,predYLog,'r--','linewidth',lw);
legend(mLeg);
PlotBeautify();
SaveCurrentFigure('./5_Output/SingleExp3_ModelFigureExample')
